import numpy as np
import pyvista as pv

DIRECTIONS = np.array([
  [    0.000000,     0.000000,    -1.000000],
  [    0.000000,     0.000000,     1.000000],
  [    0.425326,    -0.309017,     0.850651],
  [    0.723607,    -0.525731,     0.447213],
  [    0.951057,    -0.309017,     0.000000],
  [    0.425326,     0.309017,     0.850651],
  [    0.723607,     0.525731,     0.447213],
  [    0.587785,     0.809017,     0.000000],
  [   -0.162460,     0.500000,     0.850651],
  [   -0.276393,     0.850651,     0.447213],
  [   -0.587785,     0.809017,     0.000000],
  [   -0.525731,     0.000000,     0.850651],
  [   -0.894427,     0.000000,     0.447213],
  [   -0.951057,    -0.309017,     0.000000],
  [   -0.162460,    -0.500000,     0.850651],
  [   -0.276393,    -0.850651,     0.447213],
  [1.794897e-09,    -1.000000,     0.000000],
  [   -0.425326,    -0.309017,    -0.850651],
  [   -0.723607,    -0.525731,    -0.447213],
  [   -0.587785,    -0.809017,     0.000000],
  [   -0.425326,     0.309017,    -0.850651],
  [   -0.723607,     0.525731,    -0.447213],
  [   -0.951057,     0.309017,     0.000000],
  [    0.162460,     0.500000,    -0.850651],
  [    0.276393,     0.850651,    -0.447213],
  [1.794897e-09,     1.000000,     0.000000],
  [    0.525731,     0.000000,    -0.850651],
  [    0.894427,     0.000000,    -0.447213],
  [    0.951057,     0.309017,     0.000000],
  [    0.162460,    -0.500000,    -0.850651],
  [    0.276393,    -0.850651,    -0.447213],
  [    0.587785,    -0.809017,     0.000000],
  [    0.850651,     0.000000,     0.525731],
  [    0.262866,     0.809017,     0.525731],
  [   -0.688191,     0.500000,     0.525731],
  [   -0.688191,    -0.500000,     0.525731],
  [    0.262866,    -0.809017,     0.525731],
  [   -0.262866,    -0.809017,    -0.525731],
  [   -0.850651,     0.000000,    -0.525731],
  [   -0.262866,     0.809017,    -0.525731],
  [    0.688191,     0.500000,    -0.525731],
  [    0.688191,    -0.500000,    -0.525731]
])


if __name__ == '__main__':
  plotter = pv.Plotter(window_size=(4096, 4096), off_screen=True)

  colors = [
    '#FF0000',
    '#FFFF00',
    '#00FF00',
    '#00FFFF',
    '#FF00FF',
  ]
  angle = 25.0

  processed_directions = []
  for direction in DIRECTIONS:
    color_choices = set(colors)
    for neighbor_direction, neighbor_color in processed_directions:
      cosine = np.clip(np.dot(direction, neighbor_direction), -1.0, +1.0)
      if np.arccos(cosine)<= 2*np.deg2rad(angle):
        color_choices.discard(neighbor_color)
    color = next(iter(color_choices))

    cone = pv.Cone(
      center=-direction/2,
      direction=direction, 
      angle=angle, 
      resolution=64, 
      capping=False
    )
    plotter.add_mesh(
      cone,
      color=color
    )
    processed_directions.append((direction, color))

  plotter.screenshot('cones.png', transparent_background=True)